<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Blog Folly 6A ‚Äî Social Completo</title>
<style>
  * {
    box-sizing: border-box;
    margin: 0; padding: 0;
    font-family: Arial, sans-serif;
  }
  body {
    background: #f4f4f8;
    color: #222;
    position: relative;
    min-height: 100vh;
    padding-bottom: 60px;
  }
  header {
    background: #6c5ce7;
    color: #fff;
    padding: 15px;
    font-size: 22px;
    font-weight: bold;
    text-align: center;
  }
  .container {
    max-width: 900px;
    margin: 20px auto;
    padding: 10px;
  }
  .card {
    background: #fff;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    margin-bottom: 15px;
  }
  .input {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ddd;
    margin-bottom: 10px;
    font-family: inherit;
    font-size: 1em;
  }
  button.button {
    background: #6c5ce7;
    color: #fff;
    border: none;
    padding: 10px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  button.button:hover {
    background: #5846c6;
  }
  button.button.small {
    padding: 4px 8px;
    font-size: 0.8em;
  }
  .post {
    padding: 12px;
    border-radius: 10px;
    background: #fafafa;
    border: 1px solid #eee;
    margin-bottom: 10px;
    word-wrap: break-word;
  }
  .post-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
    cursor: pointer;
  }
  .pfp {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #999;
    color: #fff;
    font-weight: bold;
    font-size: 14px;
    user-select: none;
    border: 2px solid #6c5ce7;
  }
  .comment-box {
    margin-top: 10px;
    padding-left: 10px;
    border-left: 3px solid #6c5ce7;
  }
  .verified {
    color: #1DA1F2;
    font-weight: bold;
    cursor: default;
    position: relative;
    user-select: none;
  }
  .verified[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    background: #222;
    color: white;
    padding: 4px 7px;
    font-size: 12px;
    border-radius: 5px;
    white-space: nowrap;
    pointer-events: none;
    z-index: 9999;
  }
  /* Chat */
  #chatBox {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    height: 300px;
    overflow-y: auto;
    background: #fafafa;
    margin-bottom: 10px;
    word-wrap: break-word;
  }
  .chat-message {
    margin-bottom: 8px;
  }
  .chat-message .author {
    font-weight: bold;
    margin-right: 5px;
    cursor: pointer;
  }
  .chat-message.own {
    text-align: right;
  }
  #chatInput {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    resize: none;
  }
  #chatSendBtn {
    margin-top: 5px;
    background: #6c5ce7;
    color: #fff;
    padding: 10px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  /* Bot√£o + fixo com menu */
  #btnAddPost {
    position: fixed;
    bottom: 15px;
    right: 15px;
    width: 56px;
    height: 56px;
    background: #6c5ce7;
    color: white;
    font-size: 36px;
    font-weight: bold;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    z-index: 1000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #addMenu {
    position: fixed;
    bottom: 80px;
    right: 15px;
    background: #fff;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    border-radius: 10px;
    display: none;
    flex-direction: column;
    z-index: 1100;
  }
  #addMenu button {
    background: #6c5ce7;
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-weight: bold;
    border-radius: 8px;
    margin: 5px;
    white-space: nowrap;
  }
  #addMenu button:hover {
    background: #5846c6;
  }
  /* Modal */
  #postModal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.75);
    justify-content: center;
    align-items: center;
    z-index: 2000;
  }
  #postModal .modal-content {
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    width: 100%;
  }
  /* Contadores animados */
  .counter {
    display: inline-block;
    transition: transform 0.3s ease, color 0.3s ease;
  }
  .counter.animate {
    transform: scale(1.3);
    color: #6c5ce7;
  }
  /* √çcone Like */
  .like-icon {
    font-size: 18px;
    transition: color 0.3s ease;
  }
  .liked .like-icon {
    color: #ff4444;
    transform: scale(1.2);
  }
  /* Erro */
  .error {
    color: #ff4444;
    margin-top: 8px;
  }
</style>
</head>
<body>
<header>Blog Folly 6A</header>

<!-- Tela de login -->
<div id="welcome" style="display:flex;justify-content:center;align-items:center;height:100vh;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:10;">
  <div class="card" style="max-width:350px;">
    <h2>Entrar</h2>
    <input id="username" class="input" placeholder="Seu nome..." autocomplete="off" />
    <button class="button" onclick="entrar()">Entrar</button>
    <p id="loginError" class="error"></p>
  </div>
</div>

<!-- P√°gina de perfil -->
<div id="profilePage" style="display:none" class="container"></div>

<!-- P√°gina principal -->
<div id="main" style="display:none" class="container">

  <!-- Menu superior -->
  <div style="margin-bottom:10px;text-align:center;">
    <button class="button" onclick="mostrarAba('posts')">Posts</button>
    <button class="button" onclick="mostrarAba('videos')">V√≠deos Curtos</button>
    <button class="button" onclick="mostrarSupport()">Apoiar</button>
    <button class="button" onclick="sair()">Sair</button>
  </div>

  <!-- Aba posts -->
  <section id="postsSection" style="display:block;">
    <div class="card">
      <h3>Criar Post</h3>
      <textarea id="textPost" class="input" placeholder="Escreva algo..." rows="3"></textarea>
      <input id="mediaPost" type="file" class="input" accept="image/*,video/*" />
      <input id="tagPost" class="input" placeholder="Tags (ex: escola, aviso)" autocomplete="off" />
      <button class="button" onclick="criarPost()">Postar</button>
    </div>
    <div id="posts"></div>
  </section>

  <!-- Aba v√≠deos -->
  <section id="videosSection" style="display:none;">
    <h3>V√≠deos Curtos (at√© 3 min)</h3>
    <div id="videos"></div>
  </section>

</div>

<!-- Menu + com op√ß√µes Posts e V√≠deos Curtos -->
<div id="addMenu">
  <button onclick="abrirModalPost()">Novo Post</button>
  <button onclick="mostrarAba('videos'); toggleAddMenu(false)">V√≠deos Curtos</button>
</div>

<!-- Bot√£o + fixo -->
<button id="btnAddPost" title="Adicionar">+</button>

<!-- Modal cria√ß√£o post -->
<div id="postModal">
  <div class="modal-content">
    <h3>Criar Post</h3>
    <textarea id="modalTextPost" class="input" placeholder="Escreva algo..." rows="3"></textarea>
    <input id="modalMediaPost" type="file" class="input" accept="image/*,video/*" />
    <input id="modalTagPost" class="input" placeholder="Tags (ex: escola, aviso)" autocomplete="off" />
    <button class="button" onclick="validarModalPost()">Postar</button>
    <button class="button" style="background:#999; margin-left:10px;" onclick="fecharModalPost()">Cancelar</button>
    <p id="modalPostError" class="error"></p>
  </div>
</div>

<!-- Modal apoio Pix -->
<div id="supportModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.75);align-items:center;justify-content:center;z-index:9999;display:flex;">
  <div style="background:#fff;padding:20px;border-radius:10px;text-align:center;margin:auto;">
    <h3>Doe via Pix</h3>
    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=pix:arthurmarinho199308@gmail.com" alt="QR Pix" /><br /><br />
    <button class="button" onclick="fecharSupport()">Fechar</button>
  </div>
</div>

<!-- Sons do site -->
<audio id="soundLike" src="https://www.soundjay.com/buttons/sounds/button-09.mp3" preload="auto"></audio>
<audio id="soundPost" src="https://www.soundjay.com/buttons/sounds/button-10.mp3" preload="auto"></audio>
<audio id="soundComment" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>
<audio id="soundFollow" src="https://www.soundjay.com/buttons/sounds/button-4.mp3" preload="auto"></audio>

<script>
  let usuarios = JSON.parse(localStorage.getItem('usuarios') || '{}');
  let posts = JSON.parse(localStorage.getItem('posts') || '[]');
  let usuario = null;
  let abaAtual = 'posts';
  const VERIFIED_USERS = ['Arthur Marinho', 'Professora Lucia Melo'];

  // Salvar dados
  function salvar() {
    localStorage.setItem('posts', JSON.stringify(posts));
    localStorage.setItem('usuarios', JSON.stringify(usuarios));
  }

  // Carregar dados e renderizar
  function carregar() {
    posts = JSON.parse(localStorage.getItem('posts') || '[]');
    usuarios = JSON.parse(localStorage.getItem('usuarios') || '{}');
    renderPosts();
    renderVideos();
  }

  // Entrar no sistema
  function entrar() {
    const user = document.getElementById('username').value.trim();
    if (!user) {
      document.getElementById('loginError').textContent = 'Digite um nome.';
      return;
    }
    if (!usuarios[user]) {
      usuarios[user] = { seguindo: [], seguidores: [], foto: null, settings: {} };
    }
    usuario = user;
    localStorage.setItem('usuarioAtivo', usuario);
    document.getElementById('loginError').textContent = '';
    document.getElementById('welcome').style.display = 'none';
    document.getElementById('main').style.display = 'block';
    carregar();
    mostrarAba('posts');
  }

  // Mostrar aba
  function mostrarAba(aba) {
    document.getElementById('postsSection').style.display = (aba === 'posts') ? 'block' : 'none';
    document.getElementById('videosSection').style.display = (aba === 'videos') ? 'block' : 'none';
    abaAtual = aba;
    toggleAddMenu(false);
  }

  // Renderizar posts (n√£o v√≠deos)
  function renderPosts() {
    const container = document.getElementById('posts');
    container.innerHTML = '';
    posts.filter(p => !(p.tipoMidia && p.tipoMidia.startsWith('video/'))).forEach(p => {
      container.appendChild(createPostElement(p));
    });
  }

  // Renderizar v√≠deos curtos
  function renderVideos() {
    const container = document.getElementById('videos');
    container.innerHTML = '';
    posts.filter(p => p.tipoMidia && p.tipoMidia.startsWith('video/')).forEach(p => {
      container.appendChild(createPostElement(p));
    });
  }

  // Criar elemento post
  function createPostElement(p) {
    const div = document.createElement('div');
    div.className = 'post';
    div.id = 'post-' + p.id;
    const isLiked = p.curtidas.includes(usuario);

    // Prevent click on buttons from opening profile
    div.innerHTML = `
      <div class="post-header" onclick="abrirPerfil('${p.autor}')">
        <div class="pfp">${getInitials(p.autor)}</div>
        <b>${p.autor} <span class="verified" data-tooltip="Verificado">${verifiedBadge(p.autor)}</span> ${getBadge(usuarios[p.autor]?.seguidores.length || 0)}</b>
      </div>
      <div class="post-text">${p.texto ? p.texto.replace(/\n/g, '<br>') : ''}</div>
      ${p.midia
        ? (p.tipoMidia.startsWith('image/')
          ? `<br><img src="${p.midia}" style="max-width:100%;border-radius:8px;margin-top:10px;">`
          : `<br><video src="${p.midia}" controls style="max-width:100%;border-radius:8px;margin-top:10px;"></video>`)
        : ''
      }
      ${p.tag ? `<p><i>#${p.tag}</i></p>` : ''}
      <button class="button like-btn ${isLiked ? 'liked' : ''}" style="margin-top:8px" onclick="event.stopPropagation(); curtir(${p.id}, this)">
        <span class="like-icon">üëç</span> <span class="like-count">${p.curtidas.length}</span>
      </button>
      <button class="button" style="margin-top:8px" onclick="event.stopPropagation(); toggleComentarios(${p.id})">Coment√°rios (${p.comentarios.length})</button>
      ${p.autor === usuario ? `
        <button class="button small" onclick="event.stopPropagation(); excluir(${p.id})">Excluir</button>
        <button class="button small" onclick="event.stopPropagation(); editar(${p.id})">Editar</button>
      ` : ''}
      <button class="button small" onclick="event.stopPropagation(); denunciar(${p.id})">Denunciar</button>
      <div id="comments-${p.id}" style="display:none" class="comment-box"></div>
    `;
    return div;
  }

  // Obter iniciais
  function getInitials(name) {
    return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
  }

  // Curtir / descurtir
  function curtir(id, btn) {
    const p = posts.find(x => x.id === id);
    if (!p) return;
    const index = p.curtidas.indexOf(usuario);
    if (index === -1) {
      p.curtidas.push(usuario);
      btn.classList.add('liked');
    } else {
      p.curtidas.splice(index, 1);
      btn.classList.remove('liked');
    }
    btn.querySelector('.like-count').textContent = p.curtidas.length;
    animarLike(btn);
    salvar();
    renderPosts();
    renderVideos();
    playSound('soundLike');
  }

  // Anima√ß√£o like
  function animarLike(button) {
    button.classList.add('animate');
    setTimeout(() => button.classList.remove('animate'), 300);
  }

  // Mostrar/ocultar coment√°rios
  function toggleComentarios(id) {
    const box = document.getElementById(`comments-${id}`);
    if (!box) return;
    const isVisible = box.style.display === 'block';
    box.style.display = isVisible ? 'none' : 'block';
    if (!isVisible) mostrarComentarios(id);
  }

  // Mostrar coment√°rios
  function mostrarComentarios(id) {
    const p = posts.find(x => x.id === id);
    const box = document.getElementById(`comments-${id}`);
    if (!p || !box) return;
    box.innerHTML = '';
    p.comentarios.forEach((cmt, i) => {
      const pComment = document.createElement('p');
      pComment.style.cursor = cmt.autor === usuario ? 'pointer' : 'default';
      pComment.title = cmt.autor === usuario ? 'Clique para deletar seu coment√°rio' : '';
      pComment.innerHTML = `<b>${cmt.autor}:</b> ${cmt.texto}`;
      if (cmt.autor === usuario) {
        pComment.onclick = () => {
          if (confirm('Deletar seu coment√°rio?')) {
            p.comentarios.splice(i, 1);
            salvar();
            mostrarComentarios(id);
            renderPosts();
            renderVideos();
          }
        };
      }
      box.appendChild(pComment);
    });
    const input = document.createElement('input');
    input.id = `com-${id}`;
    input.className = 'input';
    input.placeholder = 'Comente...';
    box.appendChild(input);

    const sendBtn = document.createElement('button');
    sendBtn.className = 'button';
    sendBtn.textContent = 'Enviar';
    sendBtn.onclick = () => comentar(id);
    box.appendChild(sendBtn);
  }

  // Comentar post
  function comentar(id) {
    const input = document.getElementById(`com-${id}`);
    if (!input) return;
    const texto = input.value.trim();
    if (!texto) return;
    const p = posts.find(x => x.id === id);
    if (!p) return;
    p.comentarios.push({ autor: usuario, texto });
    salvar();
    mostrarComentarios(id);
    renderPosts();
    renderVideos();
    playSound('soundComment');
  }

  // Excluir post
  function excluir(id) {
    if (!confirm('Excluir esse post?')) return;
    posts = posts.filter(p => p.id !== id);
    salvar();
    renderPosts();
    renderVideos();
  }

  // Editar post texto
  function editar(id) {
    const p = posts.find(x => x.id === id);
    if (!p) return;
    const novo = prompt('Novo texto:', p.texto);
    if (novo !== null) {
      p.texto = novo;
      salvar();
      renderPosts();
      renderVideos();
    }
  }

  // Abrir perfil do usu√°rio
  function abrirPerfil(nome) {
    const p = usuarios[nome];
    if (!p) {
      alert('Usu√°rio n√£o encontrado.');
      return;
    }
    document.getElementById('main').style.display = 'none';
    const pgs = document.getElementById('profilePage');
    pgs.style.display = 'block';
    const seguindo = usuarios[usuario]?.seguindo || [];
    const jaSegue = seguindo.includes(nome);
    pgs.innerHTML = `<div class="card profile">
      <div class="pfp">${getInitials(nome)}</div>
      <h2>${nome} <span class="verified" data-tooltip="Verificado">${verifiedBadge(nome)}</span> ${getBadge(p.seguidores.length)}</h2>
      <p>Seguidores: <span class="counter" id="countSeguidores">${p.seguidores.length}</span></p>
      <p>Seguindo: <span class="counter" id="countSeguindo">${p.seguindo.length}</span></p>
      ${nome !== usuario ? `<button class="button" onclick="toggleSeguir('${nome}')">${jaSegue ? 'Desseguir' : 'Seguir'}</button>` : '<p>Voc√™ n√£o pode se seguir.</p>'}
      <button class="button" onclick="voltar()">Voltar</button>
    </div>`;
    animarContador('countSeguidores', p.seguidores.length);
    animarContador('countSeguindo', p.seguindo.length);
  }

  // Seguir/desseguir
  function toggleSeguir(nome) {
    const seguindo = usuarios[usuario]?.seguindo || [];
    if (seguindo.includes(nome)) {
      usuarios[usuario].seguindo = seguindo.filter(s => s !== nome);
      usuarios[nome].seguidores = usuarios[nome].seguidores.filter(s => s !== usuario);
    } else {
      usuarios[usuario].seguindo.push(nome);
      usuarios[nome].seguidores.push(usuario);
    }
    salvar();
    abrirPerfil(nome);
  }

  // Voltar para principal
  function voltar() {
    document.getElementById('profilePage').style.display = 'none';
    document.getElementById('main').style.display = 'block';
  }

  // Denunciar post
  function denunciar(id) {
    const p = posts.find(p => p.id === id);
    if (!p) return;
    if (p.autor === usuario) {
      alert('N√£o pode denunciar seu pr√≥prio post.');
      return;
    }
    p.reports = p.reports || [];
    if (!p.reports.includes(usuario)) p.reports.push(usuario);
    if (p.reports.length >= 5) {
      posts = posts.filter(x => x.id !== id);
      alert('Post removido por den√∫ncias.');
    } else {
      alert('Den√∫ncia registrada.');
    }
    salvar();
    renderPosts();
    renderVideos();
  }

  // Sair do sistema
  function sair() {
    if (!confirm('Deseja sair do site?')) return;
    localStorage.removeItem('usuarioAtivo');
    location.reload();
  }

  // Badge verificado
  function verifiedBadge(nome) {
    return VERIFIED_USERS.includes(nome) ? '‚úîÔ∏è' : '';
  }

  // Badge seguidores
  function getBadge(segs) {
    if (segs >= 1000000) return 'üî∂ Ouro';
    if (segs >= 1000) return 'üîπ Prata';
    if (segs >= 50) return 'ü•â Bronze';
    return '';
  }

  // Anima√ß√£o contador
  function animarContador(id, novoValor) {
    const el = document.getElementById(id);
    if (!el) return;
    el.textContent = novoValor;
    el.classList.add('animate');
    setTimeout(() => el.classList.remove('animate'), 600);
  }

  // Validar tamanho de v√≠deo no input - async for safety
  function validarArquivoVideo(input) {
    const file = input.files[0];
    if (!file || !file.type.startsWith('video/')) return;
    const url = URL.createObjectURL(file);
    const video = document.createElement('video');
    video.preload = 'metadata';
    video.onloadedmetadata = () => {
      URL.revokeObjectURL(url);
      if (video.duration > 180) {
        alert('V√≠deo deve ter at√© 3 minutos.');
        input.value = '';
      }
    };
    video.src = url;
  }
  document.getElementById('mediaPost').addEventListener('change', e => validarArquivoVideo(e.target));
  document.getElementById('modalMediaPost').addEventListener('change', e => validarArquivoVideo(e.target));

  // Modal post
  const postModal = document.getElementById('postModal');

  // Abrir modal criar post
  function abrirModalPost() {
    postModal.style.display = 'flex';
    document.getElementById('modalTextPost').value = '';
    document.getElementById('modalMediaPost').value = '';
    document.getElementById('modalTagPost').value = '';
    toggleAddMenu(false);
  }

  // Fechar modal post
  function fecharModalPost() {
    postModal.style.display = 'none';
    document.getElementById('modalPostError').textContent = '';
  }

  // Validar e criar post modal
  function validarModalPost() {
    const texto = document.getElementById('modalTextPost').value.trim();
    const arquivo = document.getElementById('modalMediaPost').files[0];
    const tag = document.getElementById('modalTagPost').value.trim();
    const errorEl = document.getElementById('modalPostError');
    errorEl.textContent = '';

    if (!texto && !arquivo) {
      errorEl.textContent = 'Adicione texto ou m√≠dia.';
      return;
    }
    if (arquivo && arquivo.type.startsWith('video/')) {
      const url = URL.createObjectURL(arquivo);
      const video = document.createElement('video');
      video.preload = 'metadata';
      video.onloadedmetadata = () => {
        URL.revokeObjectURL(url);
        if (video.duration > 180) {
          alert('V√≠deo deve ter at√© 3 minutos.');
          return;
        } else {
          criarPostModal(texto, arquivo, tag);
        }
      };
      video.src = url;
    } else {
      criarPostModal(texto, arquivo, tag);
    }
  }

  // Criar post modal
  function criarPostModal(texto, arquivo, tag) {
    let midia = null;
    let tipo = null;
    if (arquivo) {
      midia = URL.createObjectURL(arquivo);
      tipo = arquivo.type;
    }
    const post = {
      id: Date.now(),
      autor: usuario,
      fotoAutor: null,
      texto: texto,
      midia: midia,
      tipoMidia: tipo,
      tag: tag,
      curtidas: [],
      comentarios: [],
      reports: []
    };
    posts.unshift(post);
    salvar();
    fecharModalPost();
    if (tipo && tipo.startsWith('video/')) mostrarAba('videos');
    else mostrarAba('posts');
    renderPosts();
    renderVideos();
    playSound('soundPost');
  }

  // Criar post direto do formul√°rio
  function criarPost() {
    const texto = document.getElementById('textPost').value.trim();
    const fileInput = document.getElementById('mediaPost');
    const arquivo = fileInput.files[0];
    const tag = document.getElementById('tagPost').value.trim();

    if (!texto && !arquivo) {
      alert('Adicione texto ou m√≠dia.');
      return;
    }
    if (arquivo && arquivo.type.startsWith('video/')) {
      const url = URL.createObjectURL(arquivo);
      const video = document.createElement('video');
      video.preload = 'metadata';
      video.onloadedmetadata = () => {
        URL.revokeObjectURL(url);
        if (video.duration > 180) {
          alert('V√≠deo deve ter at√© 3 minutos.');
          fileInput.value = '';
        } else {
          adicionarPost(texto, arquivo, tag);
        }
      };
      video.src = url;
    } else {
      adicionarPost(texto, arquivo, tag);
    }
  }

  // Adicionar post direto
  function adicionarPost(texto, arquivo, tag) {
    let midia = null;
    let tipo = null;
    if (arquivo) {
      midia = URL.createObjectURL(arquivo);
      tipo = arquivo.type;
    }
    const post = {
      id: Date.now(),
      autor: usuario,
      fotoAutor: null,
      texto: texto,
      midia: midia,
      tipoMidia: tipo,
      tag: tag,
      curtidas: [],
      comentarios: [],
      reports: []
    };
    posts.unshift(post);
    salvar();
    document.getElementById('textPost').value = '';
    document.getElementById('mediaPost').value = '';
    document.getElementById('tagPost').value = '';
    if (tipo && tipo.startsWith('video/')) mostrarAba('videos');
    else mostrarAba('posts');
    renderPosts();
    renderVideos();
    playSound('soundPost');
  }

  // Tocar som respeitando flags (n√£o h√° configura√ß√£o, s√≥ ativa)
  function playSound(id) {
    const s = document.getElementById(id);
    if (s) {
      s.currentTime = 0;
      s.play();
    }
  }

  // Bot√£o + com menu toggle
  const btnAddPost = document.getElementById('btnAddPost');
  const addMenu = document.getElementById('addMenu');
  btnAddPost.addEventListener('click', () => toggleAddMenu());

  function toggleAddMenu(force) {
    if (typeof force === 'boolean') {
      addMenu.style.display = force ? 'flex' : 'none';
    } else {
      addMenu.style.display = addMenu.style.display === 'flex' ? 'none' : 'flex';
    }
  }

  // Auto login
  window.onload = () => {
    const localUser = localStorage.getItem('usuarioAtivo');
    if (localUser && usuarios[localUser]) {
      usuario = localUser;
      document.getElementById('welcome').style.display = 'none';
      document.getElementById('main').style.display = 'block';
      carregar();
      mostrarAba('posts');
    }
  };

  // Fechar modal ao clicar fora
  postModal.addEventListener('click', e => {
    if (e.target === e.currentTarget) fecharModalPost();
  });

  // Mostrar modal apoio Pix
  function mostrarSupport() {
    document.getElementById('supportModal').style.display = 'flex';
  }

  // Fechar modal apoio Pix
  function fecharSupport() {
    document.getElementById('supportModal').style.display = 'none';
  }
</script>

</body>
</html>
